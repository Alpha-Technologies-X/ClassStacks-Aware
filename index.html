<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/x-icon" href="/ClassStacks-Aware/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ClassStacks Aware - Enhanced Monitoring Dashboard</title>
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --danger: #e63946;
            --success: #2a9d8f;
            --warning: #f4a261;
            --dark: #212529;
            --light: #f8f9fa;
            --sidebar: #2c3e50;
            --sidebar-hover: #34495e;
            --aware-primary: #6a11cb;
            --aware-secondary: #2575fc;
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
            --radius-round: 50px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: #f5f7fb;
            color: var(--dark);
            overflow-x: hidden;
        }
        
        /* Authentication Styles */
        .auth-container {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background: linear-gradient(135deg, var(--aware-primary) 0%, var(--aware-secondary) 100%);
            padding: 20px;
            overflow-y: auto;
        }
        
        .auth-box {
            background: white;
            padding: 40px;
            border-radius: var(--radius-xl);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 500px;
            margin: 20px 0;
        }
        
        .auth-logo {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .auth-logo h1 {
            color: var(--aware-primary);
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .auth-tabs {
            display: flex;
            margin-bottom: 25px;
            border-bottom: 1px solid #e1e5ee;
        }
        
        .auth-tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            border-radius: var(--radius-sm) var(--radius-sm) 0 0;
        }
        
        .auth-tab.active {
            color: var(--aware-primary);
            border-bottom-color: var(--aware-primary);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 14px;
            border: 2px solid #e1e5ee;
            border-radius: var(--radius-md);
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--aware-primary);
            box-shadow: 0 0 0 3px rgba(106, 17, 203, 0.1);
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--radius-md);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--aware-primary) 0%, var(--aware-secondary) 100%);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--danger) 0%, #e63946 100%);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success) 0%, #2a9d8f 100%);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, var(--warning) 0%, #f4a261 100%);
            color: white;
        }
        
        .btn-outline {
            background: transparent;
            color: var(--aware-primary);
            border: 2px solid var(--aware-primary);
            border-radius: var(--radius-md);
        }
        
        .error-message {
            color: var(--danger);
            text-align: center;
            margin-top: 15px;
            padding: 12px;
            background: #ffeaea;
            border-radius: var(--radius-md);
            display: none;
        }
        
        .success-message {
            color: var(--success);
            text-align: center;
            margin-top: 15px;
            padding: 12px;
            background: #e8f5e8;
            border-radius: var(--radius-md);
            display: none;
        }
        
        .auth-toggle {
            text-align: center;
            margin-top: 20px;
            font-size: 0.9rem;
        }
        
        .auth-toggle a {
            color: var(--aware-primary);
            text-decoration: none;
            font-weight: 600;
        }
        
        .auth-toggle a:hover {
            text-decoration: underline;
        }
        
        /* Dashboard Layout */
        .dashboard {
            display: none;
            flex-direction: column;
            height: 100vh;
        }
        
        .dashboard-header {
            background: white;
            padding: 0 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
            z-index: 100;
            background: linear-gradient(135deg, var(--aware-primary) 0%, var(--aware-secondary) 100%);
            color: white;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: white;
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .dashboard-body {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        
        .sidebar {
            background: var(--sidebar);
            color: white;
            width: 250px;
            overflow-y: auto;
            padding: 20px 0;
        }
        
        .sidebar-menu {
            list-style: none;
        }
        
        .sidebar-item {
            padding: 15px 25px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 12px;
            border-radius: var(--radius-sm);
            margin: 0 10px;
        }
        
        .sidebar-item:hover {
            background: var(--sidebar-hover);
            transform: translateX(5px);
        }
        
        .sidebar-item.active {
            background: linear-gradient(135deg, var(--aware-primary) 0%, var(--aware-secondary) 100%);
            box-shadow: 0 4px 12px rgba(106, 17, 203, 0.3);
        }
        
        .main-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        
        /* Content Header */
        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .content-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--dark);
        }
        
        .btn-sm {
            padding: 8px 16px;
            font-size: 13px;
            border-radius: var(--radius-sm);
        }
        
        .btn-lg {
            padding: 16px 32px;
            font-size: 16px;
            border-radius: var(--radius-lg);
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: var(--radius-lg);
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            text-align: center;
            border-left: 6px solid var(--aware-primary);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--aware-primary) 0%, var(--aware-secondary) 100%);
            border-radius: var(--radius-lg) var(--radius-lg) 0 0;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--aware-primary);
            margin-bottom: 10px;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.95rem;
        }
        
        /* Content Cards */
        .content-card {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            margin-bottom: 25px;
            overflow: hidden;
            transition: all 0.3s;
        }
        
        .content-card:hover {
            box-shadow: 0 8px 20px rgba(0,0,0,0.08);
        }
        
        .card-header {
            padding: 20px 25px;
            border-bottom: 1px solid #e1e5ee;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
        }
        
        .card-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--dark);
        }
        
        .card-body {
            padding: 25px;
        }
        
        /* Tabs for Class Management */
        .section-tabs {
            display: flex;
            margin-bottom: 25px;
            border-bottom: 1px solid #e1e5ee;
        }
        
        .section-tab {
            padding: 12px 24px;
            cursor: pointer;
            font-weight: 600;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            border-radius: var(--radius-sm) var(--radius-sm) 0 0;
        }
        
        .section-tab:hover {
            color: var(--aware-primary);
            background: #f8f9fa;
        }
        
        .section-tab.active {
            color: var(--aware-primary);
            border-bottom-color: var(--aware-primary);
            background: #f8f9fa;
        }
        
        .section-content {
            display: none;
            animation: fadeIn 0.3s ease-out;
        }
        
        .section-content.active {
            display: block;
        }
        
        /* Student Grid */
        .students-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }
        
        .student-card {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            padding: 20px;
            border: 1px solid #e1e5ee;
            position: relative;
            overflow: hidden;
        }
        
        .student-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--success) 0%, #2a9d8f 100%);
        }
        
        .student-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--aware-primary) 0%, var(--aware-secondary) 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            margin: 0 auto 15px;
        }
        
        /* Class Cards */
        .class-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .class-card {
            background: white;
            border-radius: var(--radius-lg);
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            padding: 25px;
            transition: all 0.3s;
            cursor: pointer;
            border: 1px solid #e1e5ee;
            position: relative;
            overflow: hidden;
        }
        
        .class-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .class-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--aware-primary) 0%, var(--aware-secondary) 100%);
            border-radius: var(--radius-lg) var(--radius-lg) 0 0;
        }
        
        .class-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .class-name {
            font-weight: 600;
            font-size: 1.2rem;
        }
        
        .class-code {
            font-family: monospace;
            background: #f8f9fa;
            padding: 8px 12px;
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            border: 1px solid #e1e5ee;
        }
        
        .class-info {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 20px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: var(--radius-sm);
        }
        
        .class-stats {
            display: flex;
            gap: 15px;
        }
        
        .class-stat {
            text-align: center;
            flex: 1;
            padding: 15px;
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border-radius: var(--radius-md);
            border: 1px solid #e1e5ee;
        }
        
        .class-stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--aware-primary);
        }
        
        .class-stat-label {
            font-size: 0.8rem;
            color: #666;
        }
        
        .class-actions {
            margin-top: 20px;
            display: flex;
            gap: 10px;
        }
        
        /* Activity Timeline */
        .activity-timeline {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .timeline-item {
            padding: 15px;
            border-bottom: 1px solid #e1e5ee;
            display: flex;
            align-items: center;
            gap: 15px;
            border-radius: var(--radius-sm);
            transition: all 0.3s;
        }
        
        .timeline-item:hover {
            background: #f8f9fa;
            transform: translateX(5px);
        }
        
        .timeline-item:last-child {
            border-bottom: none;
        }
        
        .timeline-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--aware-primary) 0%, var(--aware-secondary) 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-size: 1.2rem;
        }
        
        .timeline-content {
            flex: 1;
        }
        
        .timeline-title {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .timeline-desc {
            font-size: 0.9rem;
            color: #666;
        }
        
        .timeline-time {
            font-size: 0.8rem;
            color: #999;
            padding: 4px 8px;
            background: #f8f9fa;
            border-radius: var(--radius-sm);
            border: 1px solid #e1e5ee;
        }
        
        /* Status Indicators */
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 5px 10px;
            border-radius: var(--radius-round);
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .status-active {
            background: #e7f7e9;
            color: var(--success);
        }
        
        .status-upcoming {
            background: #fff3cd;
            color: var(--warning);
        }
        
        .status-inactive {
            background: #f8f9fa;
            color: #666;
        }
        
        .status-locked {
            background: #ffeaea;
            color: var(--danger);
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: var(--radius-xl);
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }
        
        .modal-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, var(--aware-primary) 0%, var(--aware-secondary) 100%);
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e1e5ee;
        }
        
        .modal-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--dark);
        }
        
        .modal-close {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 2px solid #e1e5ee;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .modal-close:hover {
            background: linear-gradient(135deg, var(--danger) 0%, #e63946 100%);
            color: white;
            border-color: var(--danger);
            transform: rotate(90deg);
        }
        
        /* Student List Styles */
        .student-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #e1e5ee;
            border-radius: var(--radius-md);
            margin-bottom: 20px;
        }
        
        .student-item {
            padding: 12px 15px;
            border-bottom: 1px solid #e1e5ee;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s;
        }
        
        .student-item:hover {
            background: #f8f9fa;
        }
        
        .student-item:last-child {
            border-bottom: none;
        }
        
        .student-item-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .student-avatar-small {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--aware-primary) 0%, var(--aware-secondary) 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        /* Search Input */
        .search-box {
            position: relative;
            margin-bottom: 20px;
        }
        
        .search-box input {
            width: 100%;
            padding: 12px 45px 12px 15px;
            border: 2px solid #e1e5ee;
            border-radius: var(--radius-md);
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .search-box input:focus {
            outline: none;
            border-color: var(--aware-primary);
        }
        
        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
        }
        
        /* Responsive Design */
        @media (max-width: 1024px) {
            .sidebar {
                width: 70px;
            }
            
            .sidebar-item span {
                display: none;
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .class-grid, .students-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                padding: 20px;
                border-radius: var(--radius-lg);
            }
            
            .section-tabs {
                overflow-x: auto;
                flex-wrap: nowrap;
            }
            
            .section-tab {
                white-space: nowrap;
            }
        }
        
        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: var(--radius-sm);
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--aware-primary) 0%, var(--aware-secondary) 100%);
            border-radius: var(--radius-sm);
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, var(--aware-secondary) 0%, var(--aware-primary) 100%);
        }
        
        /* Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .aware-view {
            animation: fadeIn 0.3s ease-out;
        }
        
        /* Loading Spinner */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(106, 17, 203, 0.3);
            border-radius: 50%;
            border-top-color: var(--aware-primary);
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Table Styles */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .data-table th {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 12px 15px;
            text-align: left;
            font-weight: 600;
            color: var(--dark);
            border-bottom: 2px solid #e1e5ee;
        }
        
        .data-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e1e5ee;
        }
        
        .data-table tr:hover {
            background: #f8f9fa;
        }
        
        /* Badge Styles */
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: var(--radius-round);
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .badge-primary {
            background: rgba(67, 97, 238, 0.1);
            color: var(--primary);
        }
        
        .badge-success {
            background: rgba(42, 157, 143, 0.1);
            color: var(--success);
        }
        
        .badge-warning {
            background: rgba(244, 162, 97, 0.1);
            color: var(--warning);
        }
    </style>
</head>
<body>
    <!-- Authentication Container -->
    <div class="auth-container" id="authContainer">
        <div class="auth-box">
            <div class="auth-logo">
                <h1>üîç ClassStacks Aware</h1>
                <p>Enhanced Monitoring Dashboard</p>
            </div>
            
            <div class="auth-tabs">
                <div class="auth-tab active" id="schoolTab" onclick="showAuthTab('school')">School Admin</div>
                <div class="auth-tab" id="teacherTab" onclick="showAuthTab('teacher')">Teacher</div>
            </div>
            
            <!-- School Admin Login Form -->
            <div id="schoolAuth">
                <div class="form-group">
                    <label for="schoolEmail">Email Address</label>
                    <input type="email" id="schoolEmail" placeholder="Enter your email" required>
                </div>
                
                <div class="form-group">
                    <label for="schoolPassword">Password</label>
                    <input type="password" id="schoolPassword" placeholder="Enter your password" required>
                </div>
                
                <button class="btn btn-primary" onclick="loginSchool()" style="width: 100%;">Login as School Admin</button>
            </div>
            
            <!-- Teacher Login Form -->
            <div id="teacherAuth" style="display: none;">
                <div class="form-group">
                    <label for="teacherEmail">Email Address</label>
                    <input type="email" id="teacherEmail" placeholder="Enter your email" required>
                </div>
                
                <div class="form-group">
                    <label for="teacherPassword">Password</label>
                    <input type="password" id="teacherPassword" placeholder="Enter your password" required>
                </div>
                
                <button class="btn btn-primary" onclick="loginTeacher()" style="width: 100%;">Login as Teacher</button>
            </div>
            
            <div class="error-message" id="errorMessage"></div>
            <div class="success-message" id="successMessage"></div>
        </div>
    </div>

    <!-- ClassStacks Aware Dashboard -->
    <div class="dashboard" id="awareDashboard">
        <div class="dashboard-header">
            <div class="header-left">
                <div class="logo">üîç ClassStacks Aware</div>
            </div>
            <div class="header-right">
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <div>
                        <div style="font-weight: 600;" id="userName">User</div>
                        <div style="font-size: 0.8rem; opacity: 0.8;" id="userRole">Dashboard</div>
                    </div>
                </div>
                <button class="btn btn-danger" onclick="logout()">Logout</button>
            </div>
        </div>
        
        <div class="dashboard-body">
            <div class="sidebar">
                <ul class="sidebar-menu">
                    <li class="sidebar-item active" onclick="showAwareView('overview')">
                        <span>üìä</span> <span>Overview</span>
                    </li>
                    <li class="sidebar-item" onclick="showAwareView('students')">
                        <span>üë®‚Äçüéì</span> <span>Student Management</span>
                    </li>
                    <li class="sidebar-item" onclick="showAwareView('classes')">
                        <span>üë®‚Äçüè´</span> <span>Class Management</span>
                    </li>
                    <li class="sidebar-item" onclick="showAwareView('assignStudents')">
                        <span>‚ûï</span> <span>Add Students to Class</span>
                    </li>
                    <li class="sidebar-item" onclick="showAwareView('activity')">
                        <span>üìà</span> <span>Activity Timeline</span>
                    </li>
                </ul>
            </div>
            
            <div class="main-content">
                <!-- Overview View -->
                <div class="aware-view" id="overviewView">
                    <div class="content-header">
                        <div class="content-title">Monitoring Dashboard Overview</div>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="awareStudents">0</div>
                            <div class="stat-label">Total Students</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="awareClasses">0</div>
                            <div class="stat-label">Active Classes</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="awareAssigned">0</div>
                            <div class="stat-label">Students in Classes</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="awareUnassigned">0</div>
                            <div class="stat-label">Unassigned Students</div>
                        </div>
                    </div>
                    
                    <div class="content-card">
                        <div class="card-header">
                            <div class="card-title">Recent Student Activity</div>
                        </div>
                        <div class="card-body">
                            <div class="activity-timeline" id="recentActivity">
                                <!-- Recent activity will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Student Management View -->
                <div class="aware-view" id="studentsView" style="display: none;">
                    <div class="content-header">
                        <div class="content-title">Student Management</div>
                        <button class="btn btn-primary" onclick="showAddStudentModal()">
                            <span>‚ûï</span> Add New Student
                        </button>
                    </div>
                    
                    <div class="content-card">
                        <div class="card-header">
                            <div class="card-title">All Students</div>
                            <div class="search-box">
                                <input type="text" id="studentSearch" placeholder="Search students..." onkeyup="searchStudents()">
                                <span class="search-icon">üîç</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Student</th>
                                        <th>Student ID</th>
                                        <th>Classes Assigned</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="studentsTable">
                                    <!-- Students will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Class Management View -->
                <div class="aware-view" id="classesView" style="display: none;">
                    <div class="content-header">
                        <div class="content-title">Class Management</div>
                        <button class="btn btn-primary" onclick="showCreateClassModal()">
                            <span>‚ûï</span> Create New Class
                        </button>
                    </div>
                    
                    <div class="content-card">
                        <div class="card-header">
                            <div class="card-title">All Classes</div>
                        </div>
                        <div class="card-body">
                            <div class="class-grid" id="classesGrid">
                                <!-- Classes will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Add Students to Class View -->
                <div class="aware-view" id="assignStudentsView" style="display: none;">
                    <div class="content-header">
                        <div class="content-title">Add Students to Class</div>
                    </div>
                    
                    <div class="content-card">
                        <div class="card-header">
                            <div class="card-title">Select Class and Students</div>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label for="assignClassSelect">Select Class</label>
                                <select id="assignClassSelect" class="form-control" onchange="updateStudentListForClass()">
                                    <option value="">Select a class</option>
                                </select>
                            </div>
                            
                            <div id="classInfo" style="display: none; margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: var(--radius-md);">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <h4 id="classNameDisplay"></h4>
                                        <p id="classDetailsDisplay"></p>
                                    </div>
                                    <div class="badge badge-primary" id="studentCountDisplay">0 students</div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="assignStudentSearch">Search Students to Add</label>
                                <div class="search-box">
                                    <input type="text" id="assignStudentSearch" placeholder="Search students by name or ID..." onkeyup="searchAvailableStudents()">
                                    <span class="search-icon">üîç</span>
                                </div>
                            </div>
                            
                            <div class="student-list" id="availableStudents">
                                <!-- Available students will be populated here -->
                            </div>
                            
                            <button class="btn btn-primary" onclick="addSelectedStudentsToClass()" style="width: 100%; margin-top: 20px;" id="addStudentsBtn" disabled>
                                <span>‚ûï</span> Add Selected Students to Class
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Activity Timeline View -->
                <div class="aware-view" id="activityView" style="display: none;">
                    <div class="content-header">
                        <div class="content-title">Activity Timeline</div>
                    </div>
                    
                    <div class="content-card">
                        <div class="card-body">
                            <div class="activity-timeline" id="fullActivityTimeline">
                                <!-- Full activity timeline will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    
    <!-- Add Student Modal -->
    <div class="modal" id="addStudentModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Add New Student</div>
                <button class="modal-close" onclick="closeModal('addStudentModal')">√ó</button>
            </div>
            
            <div class="form-group">
                <label for="newStudentFirstName">First Name</label>
                <input type="text" id="newStudentFirstName" placeholder="Enter student first name" class="form-control" required>
            </div>
            
            <div class="form-group">
                <label for="newStudentLastName">Last Name</label>
                <input type="text" id="newStudentLastName" placeholder="Enter student last name" class="form-control" required>
            </div>
            
            <div class="form-group">
                <label for="newStudentEmail">Email Address</label>
                <input type="email" id="newStudentEmail" placeholder="Enter student email (optional)" class="form-control">
            </div>
            
            <div class="form-group">
                <label for="newStudentID">Student ID</label>
                <input type="text" id="newStudentID" placeholder="Enter student ID (optional)" class="form-control">
            </div>
            
            <div class="form-group">
                <label for="newStudentGrade">Grade Level</label>
                <select id="newStudentGrade" class="form-control">
                    <option value="">Select grade level</option>
                    <option value="1">Grade 1</option>
                    <option value="2">Grade 2</option>
                    <option value="3">Grade 3</option>
                    <option value="4">Grade 4</option>
                    <option value="5">Grade 5</option>
                    <option value="6">Grade 6</option>
                    <option value="7">Grade 7</option>
                    <option value="8">Grade 8</option>
                    <option value="9">Grade 9</option>
                    <option value="10">Grade 10</option>
                    <option value="11">Grade 11</option>
                    <option value="12">Grade 12</option>
                    <option value="college">College</option>
                </select>
            </div>
            
            <button class="btn btn-primary" onclick="addNewStudent()" style="width: 100%; padding: 14px;">
                <span>‚ûï</span> Add Student
            </button>
        </div>
    </div>
    
    <!-- Create Class Modal -->
    <div class="modal" id="createClassModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Create New Class</div>
                <button class="modal-close" onclick="closeModal('createClassModal')">√ó</button>
            </div>
            
            <div class="form-group">
                <label for="newClassName">Class Name</label>
                <input type="text" id="newClassName" placeholder="e.g., Mathematics 101" class="form-control" required>
            </div>
            
            <div class="form-group">
                <label for="newClassSubject">Subject</label>
                <input type="text" id="newClassSubject" placeholder="e.g., Mathematics" class="form-control" required>
            </div>
            
            <div class="form-group">
                <label for="newClassGrade">Grade Level</label>
                <select id="newClassGrade" class="form-control">
                    <option value="">Select grade level</option>
                    <option value="1">Grade 1</option>
                    <option value="2">Grade 2</option>
                    <option value="3">Grade 3</option>
                    <option value="4">Grade 4</option>
                    <option value="5">Grade 5</option>
                    <option value="6">Grade 6</option>
                    <option value="7">Grade 7</option>
                    <option value="8">Grade 8</option>
                    <option value="9">Grade 9</option>
                    <option value="10">Grade 10</option>
                    <option value="11">Grade 11</option>
                    <option value="12">Grade 12</option>
                    <option value="college">College</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="newClassTeacher">Teacher Name</label>
                <input type="text" id="newClassTeacher" placeholder="e.g., Mr. Johnson" class="form-control">
            </div>
            
            <div class="form-group">
                <label for="newClassDescription">Description (Optional)</label>
                <textarea id="newClassDescription" rows="3" placeholder="Enter class description" class="form-control"></textarea>
            </div>
            
            <button class="btn btn-primary" onclick="createNewClass()" style="width: 100%; padding: 14px;">
                <span>‚ûï</span> Create Class
            </button>
        </div>
    </div>
    
    <!-- View Class Details Modal -->
    <div class="modal" id="viewClassModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Class Details</div>
                <button class="modal-close" onclick="closeModal('viewClassModal')">√ó</button>
            </div>
            
            <div id="classDetailsContent">
                <!-- Class details will be populated here -->
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let currentView = 'overview';
        let selectedStudents = new Set();
        
        // Initialize the application
        function initializeApp() {
            // Check if user is already logged in
            const savedUser = localStorage.getItem('awareCurrentUser');
            
            if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    showAwareDashboard();
                } catch (e) {
                    console.error('Error parsing user data:', e);
                    showAuthTab('school');
                }
            } else {
                // No user logged in, show login page
                showAuthTab('school');
            }
            
            // Initialize data structure if it doesn't exist
            initializeData();
        }
        
        // Initialize data structure
        function initializeData() {
            const data = getSharedData();
            
            // Ensure all required structures exist
            if (!data.schools) data.schools = {};
            if (!data.teachers) data.teachers = {};
            if (!data.students) data.students = {};
            if (!data.classes) data.classes = {};
            if (!data.studentClasses) data.studentClasses = {};
            if (!data.activityLogs) data.activityLogs = [];
            
            // Add some demo data if empty
            if (Object.keys(data.students).length === 0) {
                addDemoData();
            }
            
            saveSharedData(data);
        }
        
        // Add demo data
        function addDemoData() {
            const data = getSharedData();
            
            // Add demo students
            const demoStudents = [
                { id: 'student_1', firstName: 'John', lastName: 'Smith', email: 'john.smith@school.edu', studentId: 'S001', grade: '10' },
                { id: 'student_2', firstName: 'Sarah', lastName: 'Johnson', email: 'sarah.j@school.edu', studentId: 'S002', grade: '10' },
                { id: 'student_3', firstName: 'Michael', lastName: 'Williams', email: 'michael.w@school.edu', studentId: 'S003', grade: '11' },
                { id: 'student_4', firstName: 'Emily', lastName: 'Brown', email: 'emily.b@school.edu', studentId: 'S004', grade: '11' },
                { id: 'student_5', firstName: 'David', lastName: 'Jones', email: 'david.j@school.edu', studentId: 'S005', grade: '12' },
                { id: 'student_6', firstName: 'Jessica', lastName: 'Miller', email: 'jessica.m@school.edu', studentId: 'S006', grade: '12' },
                { id: 'student_7', firstName: 'Daniel', lastName: 'Davis', email: 'daniel.d@school.edu', studentId: 'S007', grade: '9' },
                { id: 'student_8', firstName: 'Olivia', lastName: 'Garcia', email: 'olivia.g@school.edu', studentId: 'S008', grade: '9' }
            ];
            
            demoStudents.forEach(student => {
                data.students[student.id] = student;
            });
            
            // Add demo classes
            const demoClasses = [
                { id: 'class_1', name: 'Mathematics 101', subject: 'Mathematics', grade: '10', teacher: 'Mr. Johnson', description: 'Introductory Algebra' },
                { id: 'class_2', name: 'English Literature', subject: 'English', grade: '11', teacher: 'Ms. Thompson', description: 'American Literature Survey' },
                { id: 'class_3', name: 'Biology Honors', subject: 'Science', grade: '12', teacher: 'Dr. Wilson', description: 'Advanced Biology Course' },
                { id: 'class_4', name: 'World History', subject: 'History', grade: '9', teacher: 'Mr. Roberts', description: 'World History from Ancient to Modern' }
            ];
            
            demoClasses.forEach(cls => {
                data.classes[cls.id] = cls;
            });
            
            // Add some student-class assignments
            data.studentClasses = {
                'student_1': ['class_1'],
                'student_2': ['class_1'],
                'student_3': ['class_2'],
                'student_4': ['class_2', 'class_3'],
                'student_5': ['class_3']
            };
            
            saveSharedData(data);
        }
        
        // Get shared data
        function getSharedData() {
            const defaultData = {
                schools: {},
                teachers: {},
                students: {},
                classes: {},
                studentClasses: {},
                activityLogs: [],
                lastUpdated: Date.now()
            };
            
            try {
                const stored = localStorage.getItem('awareData');
                if (stored) {
                    const parsed = JSON.parse(stored);
                    return {...defaultData, ...parsed};
                }
            } catch (e) {
                console.error('Error parsing stored data:', e);
            }
            
            return defaultData;
        }
        
        // Save shared data
        function saveSharedData(data) {
            data.lastUpdated = Date.now();
            localStorage.setItem('awareData', JSON.stringify(data));
        }
        
        // Show authentication tab
        function showAuthTab(tab) {
            document.getElementById('schoolTab').classList.remove('active');
            document.getElementById('teacherTab').classList.remove('active');
            
            document.getElementById('schoolAuth').style.display = 'none';
            document.getElementById('teacherAuth').style.display = 'none';
            
            if (tab === 'school') {
                document.getElementById('schoolTab').classList.add('active');
                document.getElementById('schoolAuth').style.display = 'block';
            } else if (tab === 'teacher') {
                document.getElementById('teacherTab').classList.add('active');
                document.getElementById('teacherAuth').style.display = 'block';
            }
        }
        
        // Show error message
        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }
        
        // Show success message
        function showSuccess(message) {
            const successDiv = document.getElementById('successMessage');
            successDiv.textContent = message;
            successDiv.style.display = 'block';
            setTimeout(() => {
                successDiv.style.display = 'none';
            }, 5000);
        }
        
        // Login as school admin
        function loginSchool() {
            const email = document.getElementById('schoolEmail').value;
            const password = document.getElementById('schoolPassword').value;
            
            if (!email || !password) {
                showError('Please enter both email and password');
                return;
            }
            
            // For demo purposes, accept any login
            currentUser = {
                id: 'admin_1',
                name: 'School Administrator',
                email: email,
                role: 'school',
                school: 'Demo School'
            };
            
            localStorage.setItem('awareCurrentUser', JSON.stringify(currentUser));
            showAwareDashboard();
        }
        
        // Login as teacher
        function loginTeacher() {
            const email = document.getElementById('teacherEmail').value;
            const password = document.getElementById('teacherPassword').value;
            
            if (!email || !password) {
                showError('Please enter both email and password');
                return;
            }
            
            // For demo purposes, accept any login
            currentUser = {
                id: 'teacher_1',
                name: 'Demo Teacher',
                email: email,
                role: 'teacher',
                school: 'Demo School'
            };
            
            localStorage.setItem('awareCurrentUser', JSON.stringify(currentUser));
            showAwareDashboard();
        }
        
        // Show Aware dashboard
        function showAwareDashboard() {
            document.getElementById('authContainer').style.display = 'none';
            document.getElementById('awareDashboard').style.display = 'flex';
            
            // Update user info
            document.getElementById('userName').textContent = currentUser.name;
            document.getElementById('userAvatar').textContent = currentUser.name.charAt(0).toUpperCase();
            document.getElementById('userRole').textContent = currentUser.role === 'school' ? 'School Admin' : 'Teacher';
            
            // Update dashboard
            updateAwareDashboard();
        }
        
        // Show aware view
        function showAwareView(view) {
            currentView = view;
            
            // Update sidebar active item
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Find and activate the correct sidebar item
            const sidebarItems = document.querySelectorAll('.sidebar-item');
            for (let i = 0; i < sidebarItems.length; i++) {
                if (sidebarItems[i].textContent.includes(getViewName(view))) {
                    sidebarItems[i].classList.add('active');
                    break;
                }
            }
            
            document.querySelectorAll('.aware-view').forEach(view => {
                view.style.display = 'none';
            });
            
            document.getElementById(view + 'View').style.display = 'block';
            
            // Update the view
            updateAwareView();
        }
        
        // Get view name from ID
        function getViewName(viewId) {
            const viewNames = {
                'overview': 'Overview',
                'students': 'Student Management',
                'classes': 'Class Management',
                'assignStudents': 'Add Students to Class',
                'activity': 'Activity Timeline'
            };
            return viewNames[viewId] || viewId;
        }
        
        // Update aware view
        function updateAwareView() {
            switch(currentView) {
                case 'overview':
                    updateOverview();
                    break;
                case 'students':
                    updateStudents();
                    break;
                case 'classes':
                    updateClasses();
                    break;
                case 'assignStudents':
                    updateAssignStudents();
                    break;
                case 'activity':
                    updateActivity();
                    break;
            }
        }
        
        // Update overview
        function updateOverview() {
            const data = getSharedData();
            
            // Get statistics
            const totalStudents = Object.keys(data.students).length;
            const totalClasses = Object.keys(data.classes).length;
            
            let assignedStudents = 0;
            Object.keys(data.studentClasses).forEach(studentId => {
                if (data.studentClasses[studentId] && data.studentClasses[studentId].length > 0) {
                    assignedStudents++;
                }
            });
            
            const unassignedStudents = totalStudents - assignedStudents;
            
            // Update stats
            document.getElementById('awareStudents').textContent = totalStudents;
            document.getElementById('awareClasses').textContent = totalClasses;
            document.getElementById('awareAssigned').textContent = assignedStudents;
            document.getElementById('awareUnassigned').textContent = unassignedStudents;
            
            // Update recent activity
            updateRecentActivity();
        }
        
        // Update recent activity
        function updateRecentActivity() {
            const data = getSharedData();
            const activities = data.activityLogs.slice(-5).reverse();
            
            const container = document.getElementById('recentActivity');
            container.innerHTML = '';
            
            activities.forEach(activity => {
                const item = document.createElement('div');
                item.className = 'timeline-item';
                
                let icon = 'üìä';
                if (activity.type === 'student_added') icon = 'üë®‚Äçüéì';
                else if (activity.type === 'class_created') icon = 'üë®‚Äçüè´';
                else if (activity.type === 'student_assigned') icon = '‚ûï';
                
                item.innerHTML = `
                    <div class="timeline-icon">${icon}</div>
                    <div class="timeline-content">
                        <div class="timeline-title">${activity.title || 'Activity'}</div>
                        <div class="timeline-desc">${activity.description || ''}</div>
                    </div>
                    <div class="timeline-time">${formatTime(activity.timestamp)}</div>
                `;
                container.appendChild(item);
            });
        }
        
        // Update students view
        function updateStudents() {
            const data = getSharedData();
            const students = Object.values(data.students);
            
            const container = document.getElementById('studentsTable');
            container.innerHTML = '';
            
            students.forEach(student => {
                const studentClasses = data.studentClasses[student.id] || [];
                const classNames = studentClasses.map(classId => {
                    const cls = data.classes[classId];
                    return cls ? cls.name : classId;
                }).join(', ');
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div class="student-avatar-small">${student.firstName.charAt(0)}${student.lastName.charAt(0)}</div>
                            <div>
                                <div style="font-weight: 500;">${student.firstName} ${student.lastName}</div>
                                <div style="font-size: 0.8rem; color: #666;">${student.email || 'No email'}</div>
                            </div>
                        </div>
                    </td>
                    <td>${student.studentId || 'N/A'}</td>
                    <td>${classNames || 'No classes assigned'}</td>
                    <td>
                        <span class="status-indicator ${studentClasses.length > 0 ? 'status-active' : 'status-inactive'}">
                            ${studentClasses.length > 0 ? 'Assigned' : 'Unassigned'}
                        </span>
                    </td>
                    <td>
                        <button class="btn btn-sm btn-primary" onclick="viewStudent('${student.id}')">View</button>
                        <button class="btn btn-sm btn-warning" onclick="editStudent('${student.id}')">Edit</button>
                        <button class="btn btn-sm btn-danger" onclick="deleteStudent('${student.id}')">Remove</button>
                    </td>
                `;
                container.appendChild(row);
            });
        }
        
        // Search students
        function searchStudents() {
            const searchTerm = document.getElementById('studentSearch').value.toLowerCase();
            const rows = document.querySelectorAll('#studentsTable tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }
        
        // Update classes view
        function updateClasses() {
            const data = getSharedData();
            const classes = Object.values(data.classes);
            
            const container = document.getElementById('classesGrid');
            container.innerHTML = '';
            
            classes.forEach(cls => {
                // Count students in this class
                let studentCount = 0;
                Object.keys(data.studentClasses).forEach(studentId => {
                    if (data.studentClasses[studentId] && data.studentClasses[studentId].includes(cls.id)) {
                        studentCount++;
                    }
                });
                
                const card = document.createElement('div');
                card.className = 'class-card';
                
                card.innerHTML = `
                    <div class="class-header">
                        <div class="class-name">${cls.name}</div>
                        <div class="class-code">${cls.subject}</div>
                    </div>
                    <div class="class-info">
                        <div>Teacher: ${cls.teacher || 'Not assigned'}</div>
                        <div>Grade: ${cls.grade || 'Not specified'}</div>
                        <div>Description: ${cls.description || 'No description'}</div>
                    </div>
                    <div class="class-stats">
                        <div class="class-stat">
                            <div class="class-stat-value">${studentCount}</div>
                            <div class="class-stat-label">Students</div>
                        </div>
                        <div class="class-stat">
                            <div class="class-stat-value">${cls.grade || 'N/A'}</div>
                            <div class="class-stat-label">Grade</div>
                        </div>
                        <div class="class-stat">
                            <div class="class-stat-value">${cls.subject || 'N/A'}</div>
                            <div class="class-stat-label">Subject</div>
                        </div>
                    </div>
                    <div class="class-actions">
                        <button class="btn btn-sm btn-primary" onclick="viewClass('${cls.id}')">
                            <span>üëÅÔ∏è</span> View
                        </button>
                        <button class="btn btn-sm btn-warning" onclick="editClass('${cls.id}')">
                            <span>‚úèÔ∏è</span> Edit
                        </button>
                        <button class="btn btn-sm btn-success" onclick="addStudentsToClass('${cls.id}')">
                            <span>‚ûï</span> Add Students
                        </button>
                    </div>
                `;
                container.appendChild(card);
            });
        }
        
        // Update assign students view
        function updateAssignStudents() {
            const data = getSharedData();
            const classSelect = document.getElementById('assignClassSelect');
            
            // Populate class select
            classSelect.innerHTML = '<option value="">Select a class</option>';
            Object.values(data.classes).forEach(cls => {
                const option = document.createElement('option');
                option.value = cls.id;
                option.textContent = `${cls.name} (${cls.subject})`;
                classSelect.appendChild(option);
            });
            
            // Clear student selection
            selectedStudents.clear();
            updateAddButtonState();
            
            // Hide class info initially
            document.getElementById('classInfo').style.display = 'none';
            document.getElementById('availableStudents').innerHTML = '<div style="text-align: center; padding: 30px; color: #666;">Select a class to see available students</div>';
        }
        
        // Update student list for selected class
        function updateStudentListForClass() {
            const classId = document.getElementById('assignClassSelect').value;
            const data = getSharedData();
            
            if (!classId) {
                document.getElementById('classInfo').style.display = 'none';
                document.getElementById('availableStudents').innerHTML = '<div style="text-align: center; padding: 30px; color: #666;">Select a class to see available students</div>';
                return;
            }
            
            const cls = data.classes[classId];
            if (!cls) return;
            
            // Show class info
            document.getElementById('classInfo').style.display = 'block';
            document.getElementById('classNameDisplay').textContent = cls.name;
            document.getElementById('classDetailsDisplay').textContent = `${cls.subject} ‚Ä¢ Grade ${cls.grade} ‚Ä¢ ${cls.teacher || 'No teacher'}`;
            
            // Count students in this class
            let studentCount = 0;
            Object.keys(data.studentClasses).forEach(studentId => {
                if (data.studentClasses[studentId] && data.studentClasses[studentId].includes(classId)) {
                    studentCount++;
                }
            });
            document.getElementById('studentCountDisplay').textContent = `${studentCount} students`;
            
            // Get all students
            const allStudents = Object.values(data.students);
            
            // Filter out students already in this class
            const availableStudents = allStudents.filter(student => {
                const studentClasses = data.studentClasses[student.id] || [];
                return !studentClasses.includes(classId);
            });
            
            // Display available students
            const container = document.getElementById('availableStudents');
            container.innerHTML = '';
            
            if (availableStudents.length === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 30px; color: #666;">All students are already in this class</div>';
                return;
            }
            
            availableStudents.forEach(student => {
                const item = document.createElement('div');
                item.className = 'student-item';
                item.innerHTML = `
                    <div class="student-item-info">
                        <div class="student-avatar-small">${student.firstName.charAt(0)}${student.lastName.charAt(0)}</div>
                        <div>
                            <div style="font-weight: 500;">${student.firstName} ${student.lastName}</div>
                            <div style="font-size: 0.8rem; color: #666;">
                                ${student.studentId || 'No ID'} ‚Ä¢ Grade ${student.grade || 'N/A'}
                            </div>
                        </div>
                    </div>
                    <div>
                        <input type="checkbox" class="student-checkbox" data-id="${student.id}" onchange="toggleStudentSelection('${student.id}', this.checked)">
                    </div>
                `;
                container.appendChild(item);
            });
            
            // Clear selection
            selectedStudents.clear();
            updateAddButtonState();
        }
        
        // Toggle student selection
        function toggleStudentSelection(studentId, checked) {
            if (checked) {
                selectedStudents.add(studentId);
            } else {
                selectedStudents.delete(studentId);
            }
            updateAddButtonState();
        }
        
        // Update add button state
        function updateAddButtonState() {
            const addBtn = document.getElementById('addStudentsBtn');
            addBtn.disabled = selectedStudents.size === 0;
        }
        
        // Search available students
        function searchAvailableStudents() {
            const searchTerm = document.getElementById('assignStudentSearch').value.toLowerCase();
            const items = document.querySelectorAll('#availableStudents .student-item');
            
            items.forEach(item => {
                const text = item.textContent.toLowerCase();
                item.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }
        
        // Add selected students to class
        function addSelectedStudentsToClass() {
            const classId = document.getElementById('assignClassSelect').value;
            const data = getSharedData();
            
            if (!classId || selectedStudents.size === 0) {
                showError('Please select a class and at least one student');
                return;
            }
            
            const cls = data.classes[classId];
            if (!cls) {
                showError('Class not found');
                return;
            }
            
            let addedCount = 0;
            selectedStudents.forEach(studentId => {
                if (!data.studentClasses[studentId]) {
                    data.studentClasses[studentId] = [];
                }
                
                if (!data.studentClasses[studentId].includes(classId)) {
                    data.studentClasses[studentId].push(classId);
                    addedCount++;
                    
                    // Log activity
                    logActivity('student_assigned', 'Student Added to Class', 
                        `${getStudentName(studentId)} was added to ${cls.name}`);
                }
            });
            
            saveSharedData(data);
            showSuccess(`Added ${addedCount} student(s) to ${cls.name}`);
            
            // Refresh the view
            updateStudentListForClass();
            
            // Clear selection
            selectedStudents.clear();
            updateAddButtonState();
            
            // Update other views
            updateOverview();
            updateStudents();
            updateClasses();
        }
        
        // Update activity view
        function updateActivity() {
            const data = getSharedData();
            const activities = data.activityLogs.slice().reverse();
            
            const container = document.getElementById('fullActivityTimeline');
            container.innerHTML = '';
            
            activities.forEach(activity => {
                const item = document.createElement('div');
                item.className = 'timeline-item';
                
                let icon = 'üìä';
                if (activity.type === 'student_added') icon = 'üë®‚Äçüéì';
                else if (activity.type === 'class_created') icon = 'üë®‚Äçüè´';
                else if (activity.type === 'student_assigned') icon = '‚ûï';
                else if (activity.type === 'student_removed') icon = 'üóëÔ∏è';
                else if (activity.type === 'class_deleted') icon = '‚ùå';
                
                item.innerHTML = `
                    <div class="timeline-icon">${icon}</div>
                    <div class="timeline-content">
                        <div class="timeline-title">${activity.title || 'Activity'}</div>
                        <div class="timeline-desc">${activity.description || ''}</div>
                    </div>
                    <div class="timeline-time">${formatDate(activity.timestamp)} ${formatTime(activity.timestamp)}</div>
                `;
                container.appendChild(item);
            });
        }
        
        // Show add student modal
        function showAddStudentModal() {
            // Clear form
            document.getElementById('newStudentFirstName').value = '';
            document.getElementById('newStudentLastName').value = '';
            document.getElementById('newStudentEmail').value = '';
            document.getElementById('newStudentID').value = '';
            document.getElementById('newStudentGrade').value = '';
            
            openModal('addStudentModal');
        }
        
        // Add new student
        function addNewStudent() {
            const firstName = document.getElementById('newStudentFirstName').value;
            const lastName = document.getElementById('newStudentLastName').value;
            const email = document.getElementById('newStudentEmail').value;
            const studentId = document.getElementById('newStudentID').value;
            const grade = document.getElementById('newStudentGrade').value;
            
            if (!firstName || !lastName) {
                showError('First name and last name are required');
                return;
            }
            
            const data = getSharedData();
            const studentIdKey = 'student_' + Date.now();
            
            data.students[studentIdKey] = {
                id: studentIdKey,
                firstName: firstName,
                lastName: lastName,
                email: email || '',
                studentId: studentId || '',
                grade: grade || '',
                created: Date.now()
            };
            
            saveSharedData(data);
            
            closeModal('addStudentModal');
            showSuccess(`Student ${firstName} ${lastName} added successfully`);
            
            // Log activity
            logActivity('student_added', 'New Student Added', 
                `${firstName} ${lastName} was added to the system`);
            
            // Update views
            updateOverview();
            updateStudents();
            updateAssignStudents();
        }
        
        // Show create class modal
        function showCreateClassModal() {
            // Clear form
            document.getElementById('newClassName').value = '';
            document.getElementById('newClassSubject').value = '';
            document.getElementById('newClassGrade').value = '';
            document.getElementById('newClassTeacher').value = '';
            document.getElementById('newClassDescription').value = '';
            
            openModal('createClassModal');
        }
        
        // Create new class
        function createNewClass() {
            const name = document.getElementById('newClassName').value;
            const subject = document.getElementById('newClassSubject').value;
            const grade = document.getElementById('newClassGrade').value;
            const teacher = document.getElementById('newClassTeacher').value;
            const description = document.getElementById('newClassDescription').value;
            
            if (!name || !subject) {
                showError('Class name and subject are required');
                return;
            }
            
            const data = getSharedData();
            const classId = 'class_' + Date.now();
            
            data.classes[classId] = {
                id: classId,
                name: name,
                subject: subject,
                grade: grade || '',
                teacher: teacher || '',
                description: description || '',
                created: Date.now()
            };
            
            saveSharedData(data);
            
            closeModal('createClassModal');
            showSuccess(`Class "${name}" created successfully`);
            
            // Log activity
            logActivity('class_created', 'New Class Created', 
                `${name} (${subject}) was created`);
            
            // Update views
            updateOverview();
            updateClasses();
            updateAssignStudents();
        }
        
        // View student details
        function viewStudent(studentId) {
            const data = getSharedData();
            const student = data.students[studentId];
            
            if (!student) {
                showError('Student not found');
                return;
            }
            
            const studentClasses = data.studentClasses[student.id] || [];
            const classNames = studentClasses.map(classId => {
                const cls = data.classes[classId];
                return cls ? `<li>${cls.name} (${cls.subject})</li>` : '';
            }).join('');
            
            alert(`
                Student Details:
                =================
                Name: ${student.firstName} ${student.lastName}
                Email: ${student.email || 'N/A'}
                Student ID: ${student.studentId || 'N/A'}
                Grade: ${student.grade || 'N/A'}
                
                Classes Assigned: ${studentClasses.length}
                ${classNames ? 'List of classes:\n' + classNames : 'No classes assigned'}
            `);
        }
        
        // Edit student
        function editStudent(studentId) {
            const data = getSharedData();
            const student = data.students[studentId];
            
            if (!student) {
                showError('Student not found');
                return;
            }
            
            const newName = prompt('Enter new student name (first and last):', `${student.firstName} ${student.lastName}`);
            if (newName) {
                const [firstName, lastName] = newName.split(' ');
                if (firstName && lastName) {
                    student.firstName = firstName;
                    student.lastName = lastName;
                    saveSharedData(data);
                    showSuccess('Student updated successfully');
                    updateStudents();
                } else {
                    showError('Please enter both first and last name');
                }
            }
        }
        
        // Delete student
        function deleteStudent(studentId) {
            if (!confirm('Are you sure you want to remove this student?')) {
                return;
            }
            
            const data = getSharedData();
            const student = data.students[studentId];
            
            if (student) {
                delete data.students[studentId];
                delete data.studentClasses[studentId];
                saveSharedData(data);
                
                showSuccess(`Student ${student.firstName} ${student.lastName} removed`);
                
                // Log activity
                logActivity('student_removed', 'Student Removed', 
                    `${student.firstName} ${student.lastName} was removed from the system`);
                
                // Update views
                updateOverview();
                updateStudents();
                updateAssignStudents();
            }
        }
        
        // View class details
        function viewClass(classId) {
            const data = getSharedData();
            const cls = data.classes[classId];
            
            if (!cls) {
                showError('Class not found');
                return;
            }
            
            // Get students in this class
            const studentsInClass = [];
            Object.keys(data.studentClasses).forEach(studentId => {
                if (data.studentClasses[studentId] && data.studentClasses[studentId].includes(classId)) {
                    const student = data.students[studentId];
                    if (student) {
                        studentsInClass.push(`${student.firstName} ${student.lastName} (${student.studentId || 'No ID'})`);
                    }
                }
            });
            
            const content = `
                <h3>${cls.name}</h3>
                <p><strong>Subject:</strong> ${cls.subject}</p>
                <p><strong>Grade:</strong> ${cls.grade || 'Not specified'}</p>
                <p><strong>Teacher:</strong> ${cls.teacher || 'Not assigned'}</p>
                <p><strong>Description:</strong> ${cls.description || 'No description'}</p>
                
                <div style="margin-top: 20px;">
                    <h4>Students in this class (${studentsInClass.length})</h4>
                    ${studentsInClass.length > 0 ? 
                        `<ul style="max-height: 200px; overflow-y: auto; padding-left: 20px; margin-top: 10px;">
                            ${studentsInClass.map(student => `<li>${student}</li>`).join('')}
                        </ul>` : 
                        '<p>No students assigned to this class</p>'
                    }
                </div>
                
                <div style="margin-top: 20px; display: flex; gap: 10px;">
                    <button class="btn btn-primary" onclick="addStudentsToClass('${classId}')" style="flex: 1;">
                        <span>‚ûï</span> Add Students
                    </button>
                    <button class="btn btn-danger" onclick="deleteClass('${classId}')" style="flex: 1;">
                        <span>üóëÔ∏è</span> Delete Class
                    </button>
                </div>
            `;
            
            document.getElementById('classDetailsContent').innerHTML = content;
            openModal('viewClassModal');
        }
        
        // Edit class
        function editClass(classId) {
            const data = getSharedData();
            const cls = data.classes[classId];
            
            if (!cls) {
                showError('Class not found');
                return;
            }
            
            const newName = prompt('Enter new class name:', cls.name);
            if (newName) {
                cls.name = newName;
                saveSharedData(data);
                showSuccess('Class updated successfully');
                updateClasses();
                updateAssignStudents();
            }
        }
        
        // Add students to class from classes view
        function addStudentsToClass(classId) {
            const data = getSharedData();
            const cls = data.classes[classId];
            
            if (!cls) {
                showError('Class not found');
                return;
            }
            
            // Switch to assign students view and select this class
            showAwareView('assignStudents');
            document.getElementById('assignClassSelect').value = classId;
            updateStudentListForClass();
            
            // Scroll to top
            window.scrollTo(0, 0);
        }
        
        // Delete class
        function deleteClass(classId) {
            if (!confirm('Are you sure you want to delete this class? This will remove all student assignments but not delete the students themselves.')) {
                return;
            }
            
            const data = getSharedData();
            const cls = data.classes[classId];
            
            if (cls) {
                delete data.classes[classId];
                
                // Remove this class from all student assignments
                Object.keys(data.studentClasses).forEach(studentId => {
                    if (data.studentClasses[studentId]) {
                        data.studentClasses[studentId] = data.studentClasses[studentId].filter(cId => cId !== classId);
                        if (data.studentClasses[studentId].length === 0) {
                            delete data.studentClasses[studentId];
                        }
                    }
                });
                
                saveSharedData(data);
                closeModal('viewClassModal');
                showSuccess(`Class "${cls.name}" deleted`);
                
                // Log activity
                logActivity('class_deleted', 'Class Deleted', 
                    `${cls.name} was deleted`);
                
                // Update views
                updateOverview();
                updateClasses();
                updateAssignStudents();
            }
        }
        
        // Get student name
        function getStudentName(studentId) {
            const data = getSharedData();
            const student = data.students[studentId];
            return student ? `${student.firstName} ${student.lastName}` : 'Unknown Student';
        }
        
        // Log activity
        function logActivity(type, title, description) {
            const data = getSharedData();
            
            data.activityLogs.push({
                type: type,
                title: title,
                description: description,
                timestamp: Date.now(),
                userId: currentUser.id,
                userName: currentUser.name
            });
            
            // Keep only last 100 activities
            if (data.activityLogs.length > 100) {
                data.activityLogs = data.activityLogs.slice(-100);
            }
            
            saveSharedData(data);
        }
        
        // Format time
        function formatTime(timestamp) {
            if (!timestamp) return '';
            const date = new Date(timestamp);
            return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        }
        
        // Format date
        function formatDate(timestamp) {
            if (!timestamp) return '';
            const date = new Date(timestamp);
            return date.toLocaleDateString();
        }
        
        // Open modal
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }
        
        // Close modal
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        // Update aware dashboard
        function updateAwareDashboard() {
            updateAwareView();
        }
        
        // Logout function
        function logout() {
            currentUser = null;
            localStorage.removeItem('awareCurrentUser');
            
            // Show login page
            document.getElementById('awareDashboard').style.display = 'none';
            document.getElementById('authContainer').style.display = 'flex';
            
            // Clear form fields
            document.getElementById('schoolEmail').value = '';
            document.getElementById('schoolPassword').value = '';
            document.getElementById('teacherEmail').value = '';
            document.getElementById('teacherPassword').value = '';
            
            showSuccess('Logged out successfully!');
        }
        
        // Initialize the application when the page loads
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>
